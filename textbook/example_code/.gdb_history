ni
q
b main
r < <(./ret2libc_solution)
ni
q
set follow-fork-mode parten
set follow-fork-mode parent
b main
r < <(./ret2libc_solution.py)
ni
ni
p buf
p &buf
disassemble main
dq rbp-0x50+0x8
dq rbp
dq rbp-0x50
ni
r < <(./ret2libc_solution.py)
ni
dq 0x7fffffffde28
ni
dq 0x7fffffffde28
ni
r
r < <(./ret2libc_solution.py)
ni
c
r < <(./ret2libc_solution.py)
ni
ni
ret
return
c
search /bin/sh
q
b main
r
q
q
info proc mapping
b main
r
info proc mappings 
find /bin/sh 0x6c9000,+999999
find
help find
find 0x6c9000,+999999 /bin/sh
find 0x6cc000,+999999 /bin/sh
find 0x6cc000,+999999,/bin/sh
find 0x6cc000,+999999,"/bin/sh"
find 0x6c9000,+999999,"/bin/sh"
info proc mappings 
p system
find 0x400000,0x4xa000,"/bin/sh"
find 0x400000,0x4ca000,"/bin/sh"
find 0x400000,+0xca000,"/bin/sh"
find 0x400000,0x4ca000,"/bin/sh"
pwndbg start
q
help find
q
r
where
disassemble main
p puts
plt
p puts@plt
db 0x400470
x/3i 0x400470
q
b ret
disassemble main
b *main+81
r
plt
q
b *main+81
r
q
b *main+81
r
info proc mappings 
disassemble main
plt
p *(int*)0x400472
p hex(*(int*)0x400472)
p *(int*)0x400472
p *(long long int*)0x400472
p puts
got
q
disassemble main
b *main+90
r
q
b main
r
ni
si
si
python
print pwndbg.arch.ptrmask
python
print(pwndbg.arch.ptrmask)
python
print(hex(pwndbg.arch.ptrmask))
r
ni
si
p $rip + 0x200ba2
p *(int*)$rip + 0x200ba2
i r rip
python
print(hex(pwndbg.arch.ptrmask))
dq 0x601012
dq $rip + 0x200ba2
dq $rip+0x200ba2
context
dq $rip+0x200ba2
dq $rip+0x200ba0
dq $rip+0x200ba2
dq $rip+0x200ba2-48
dq $rip+0x200ba2
dq $rip+0x200ba2-4
dq $rip+0x200ba2
dq $rip+0x200ba2-6
dq $rip+0x200ba2-2
dq $rip+0x200ba2
db $rip+0x200ba2
db $rip+0x200ba2+6
dq $rip+0x200ba2+6
context
dq $rip+0x200ba2+6
$rip+0x200ba2+6
p $rip+0x200ba2+6
q
b puts
r
c
q
p puts
b puts
r
q
b puts
r
aslr
q
pwndbg aslr
aslr on
r
file use_leak
b puts
r
r
r
r
r
q
q
search /bin/sh
start
search /bin/sh
start
start
p write
plt
got
p main
ropgadget 
ropgadget pop
q
ropgadget 
roptool -h
ropgadget -h
ropgadget
q
ropgadget 
ropgadget rdi
q
ropgadget make_leak rid
ropgadget --binary make_leak
ropgadget --opcode rdi
ropgadget --filter rdi
ropgadget "--filter rdi"
ropgadget --filter "rdi"
ropgadget rdi
ropgadget 
ropgadget rdi 
ropgadget rdi --lol
ropgadget rdi --depth 5
ropgadget rdi "--depth 5"
ropgadget rdi '--depth'
ropgadget rdi ''
ropgadget rdi
ropgadget rdi 
ropgadget rdi ''
ropgadget '' ''
ropgadget '' ''
version
ropgadget 
ropgadget rdi
ropgadget rdi'' ''
ropgadget rdi ''
ropgadget ''
ropgadget '' ''
q
b main
r < <(./make_leak_solution.py)
ni
ds 0x7fffffffdea0
ni

ds 0x7fffffffdea0
ds 0x7fffffffdee8
ds 0x7fffffffdea0
dd 0x7fffffffdea0
db 0x7fffffffdea0
db 0x7fffffffdea0
db 0x7fffffffde90
db 0x7fffffffdea0
ni
ret
return 
c
c
q
b main
r
ni
got
puts(0x601018)
call puts(0x601018)
call hex(puts(0x601018))
call puts(0x601018)
db 0x601018
q
start
ni
got
db 0x601018
r
b main
r
ni
got
db 0x601018
got
q
b main
r
ni
got
q
